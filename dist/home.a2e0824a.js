parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"sgCL":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}function i(t,e,s,i){var a=new WebSocket("ws://"+i+"/fs/PartUpload");return new n(t,a,e,s)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSm=i;var n=function(){function e(s,i,n,h){t(this,e),this.states={READY:"READY",OPEN_WEBSOCKET:"OPEN_WEBSOCKET",READ_META:"READ_META",WRITE_META:"WRITE_META",READ_WRITE_CONTINUE_CHECK:"READ_WRITE_CONTINUE_CHECK",READ_BYTES:"READ_BYTES",WRITE_BYTES:"WRITE_BYTES",END:"END"},this.events={NO_EVENT:"NO_EVENT",READ_MORE:"READ_MORE"},this.before_func=n,this.after_func=h,this.before_func(),this.after_func(),this.websocket=i,this.file=s,this.filemeta={},this.websocket.onmessage=a(this,this.transition),this.event=this.events.NO_EVENT,this.funcMap={},this.current_state=this.states.READY,this.fileReader=new FileReader,this.offset=0,this.PACKET_SIZE=10485760,this.setTransitionFunctions()}return s(e,[{key:"print",value:function(){console.log("state:".concat(this.current_state,";event").concat(this.event))}},{key:"transition",value:function(t){this.print(),this.getNextTransitionFunc().call(this,t)}},{key:"transitionKey",value:function(){return console.log("".concat(this.current_state,":").concat(this.event)),"".concat(this.current_state,":").concat(this.event)}},{key:"getNextTransitionFunc",value:function(){return this.funcMap[this.transitionKey()]}},{key:"setTransitionFunctions",value:function(){this.funcMap[this.createTransitionKey(this.states.READY,this.events.NO_EVENT)]=this.readMeta,this.funcMap[this.createTransitionKey(this.states.OPEN_WEBSOCKET,this.events.NO_EVENT)]=this.openWebSocket,this.funcMap[this.createTransitionKey(this.states.READ_META,this.events.NO_EVENT)]=this.writeMeta,this.funcMap[this.createTransitionKey(this.states.WRITE_META,this.events.NO_EVENT)]=this.readBytes,this.funcMap[this.createTransitionKey(this.states.WRITE_BYTES,this.events.NO_EVENT)]=this.continueCheck,this.funcMap[this.createTransitionKey(this.states.READ_WRITE_CONTINUE_CHECK,this.events.READ_MORE)]=this.readBytes,this.funcMap[this.createTransitionKey(this.states.READ_WRITE_CONTINUE_CHECK,this.events.NO_EVENT)]=this.end,this.funcMap[this.createTransitionKey(this.states.READ_BYTES,this.events.NO_EVENT)]=this.writeBytes}},{key:"createTransitionKey",value:function(t,e){return"".concat(t,":").concat(e)}},{key:"openWebSocket",value:function(){this.current_state=this.states.READ_META,this.event=this.events.NO_EVENT,this.websocket.onopen=a(this,this.transition)}},{key:"readMeta",value:function(t){this.before_func(),this.current_state=this.states.OPEN_WEBSOCKET,this.event=this.events.NO_EVENT,this.filemeta={name:this.file.name,size:this.file.size},this.transition()}},{key:"writeMeta",value:function(){this.current_state=this.states.WRITE_META,this.event=this.events.NO_EVENT,this.websocket.send(JSON.stringify(this.filemeta))}},{key:"continueCheck",value:function(){this.offset>=this.filemeta.size?(this.current_state=this.states.READ_WRITE_CONTINUE_CHECK,this.event=this.events.NO_EVENT):(this.current_state=this.states.READ_WRITE_CONTINUE_CHECK,this.event=this.events.READ_MORE),this.transition()}},{key:"readBytes",value:function(){this.current_state=this.states.READ_BYTES,this.event=this.events.NO_EVENT,this.fileReader.onload=a(this,this.transition);var t=this.file.slice(this.offset,this.PACKET_SIZE+this.offset);this.fileReader.readAsArrayBuffer(t)}},{key:"writeBytes",value:function(t){this.current_state=this.states.WRITE_BYTES,this.event=this.events.NO_EVENT;var e=this.fileReader.result;this.offset+=this.PACKET_SIZE,this.websocket.send(e)}},{key:"end",value:function(){this.current_state=this.states.END,this.event=this.events.NO_EVENT,this.websocket.close(),this.after_func()}}]),e}();function a(t,e,s){var i=t;return function(){e.call(i,s)}}
},{}],"JkLK":[function(require,module,exports) {
"use strict";var e,n,t,i=require("./sm.js"),o=10485760,s=1;function c(){l(f)}function l(e){fetch("/fs/getPaginated").then(function(e){return e.json()}).then(function(n){e(n)})}function f(e){for(var n="",t=0;t<e.length;t++)n+='<tr><td><span class="fileItem"><a href="/fs/downloadFileById?id='+e[t].Id+'" target="_blank">'+e[t].FileName+'</a></td><td><img src="./resources/delete_icon.png" width="25" height="25" onclick="deleteFileById('+e[t].Id+')"></span></td></tr>';document.getElementById("filesTable").innerHTML=n}function d(e){fetch("/fs/localIp").then(function(e){return e.text()}).then(function(n){console.log(n),e(n)})}function u(e){console.log("deleting file with id "+e),fetch("/fs/deleteFileById?id="+e).then(function(e){return e.text()}).then(function(e){console.log(e),l(f)})}function a(e){d(function(n){sm=(0,i.createSm)(e.files[0],h,g,n),sm.transition})}function r(){c()}function h(){e.style.visibility="hidden",w(),t=!0,s=1,b()}function g(n,i){t=!1,e.style.visibility="visible",r()}function m(){e=document.querySelector("#wrapperDiv"),n=document.querySelector(".statusCompleted"),r(),document.getElementById("uploadFile").addEventListener("change",function(){a(this)}),v()}function y(e,n,t){console.log("sending file by parts"),console.log(n);var i=new WebSocket("ws://"+e+"/fs/PartUpload");metaInfoSent=!1,index=0,i.onopen=function(){i.send(JSON.stringify(n))},i.onmessage=function(e){switch(e.data){case"SEND_DATA":p(n,i,index),s=index*o*100/n.size,s=Math.floor(s),index++}},i.onclose=function(){t()}}function p(e,n,t){size=0,(t+1)*o<e.size?size=o:size=e.size-t*o,messagePart=e.content.slice(t*o,t*o+size),n.send(messagePart)}function w(){n.style.width="1%"}function I(){n.style.width=s+"%",t&&setTimeout(I,100)}function v(){setTimeout(function(){r(),v()},1e3)}function b(){setTimeout(I,100)}window.onload=m;
},{"./sm.js":"sgCL"}]},{},["JkLK"], null)